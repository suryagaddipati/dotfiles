#!/bin/bash

if ! git diff --cached --quiet; then
    staged_diff=$(git diff --cached)
    commit_msg=$(echo "$staged_diff" | ~/.claude/local/claude -p "Analyze these staged git changes and create a commit message that explains WHY this change was needed - what problem does it solve or what value does it add? Focus on the underlying motivation and business/user impact, not just the technical implementation. Use conventional commit format with a clear title, then explain the reasoning and benefits in the body. Only respond with the commit message and no affirmation.")
    git commit -m "$commit_msg"
    echo "Committed with message: $commit_msg"
else
    echo "No staged changes to commit"
fi
