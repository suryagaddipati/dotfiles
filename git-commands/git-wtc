#!/bin/bash

branch_name="$1"
repo_root=$(git rev-parse --show-toplevel)
worktree_path="$repo_root/.worktrees/$branch_name"

mkdir -p "$repo_root/.worktrees"

if git show-ref --verify --quiet "refs/heads/$branch_name"; then
    git worktree add "$worktree_path" "$branch_name"
else
    git worktree add -b "$branch_name" "$worktree_path"
fi

echo "cd $worktree_path"